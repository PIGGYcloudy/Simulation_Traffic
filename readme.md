
# 離散事件模擬：十字路口交通流 (Traffic Intersection DES)

這是一個基於 Python 實作的離散事件模擬 (Discrete Event Simulation, DES) 專案。模擬目標為一個具體的四路十字路口（包含交流道、市區、清大、清夜方向），並包含車輛與行人的互動機制。

SimClasses.py SimFunctions.py SimRNG.py 使用系統模擬課堂所使用的庫，未做修改。

## 🚦 路口場景示意

模擬的十字路口結構如下：

```text
          │ 清  |
          │ 大  |
          │  3  |
          │  ↓  |
 ─────────┘     └─────────
 交流道 1 →      ← 2 市區 
 ─────────┐     ┌─────────
          │  ↑  |
          │  4  |
          │ 清  |
          │ 夜  |
```

  * **道路 1**: 來自 交流道
  * **道路 2**: 來自 市區
  * **道路 3**: 來自 清大
  * **道路 4**: 來自 清夜
  * **車輛轉向**: 直走 (s), 右轉 (r), 左轉 (l)

## ⚙️ 模擬機制

### 1\. 交通號誌循環 (Traffic Cycle)

系統透過狀態機 (`traffic_state`) 控制紅綠燈循環，分為 5 個階段：

  * **State 0 (93s)**: 光復路（1 & 2）綠燈
  * **State 1 (20s)**: 光復路（1 & 2）左轉專用燈
  * **State 2 (12s)**: 建功路（3 & 4）紅燈，但行人綠燈
  * **State 3 (14s)**: 建功路（3 & 4）綠燈
  * **State 4 (12s)**: 建功路（3 & 4）綠燈，但行人紅燈

### 2\. 事件驅動 (Event Driven)

主要事件類型包括：

  * `car_arrival`: 車輛到達
  * `car_passthrough`: 車輛通過路口（受紅綠燈與前車影響）
  * `pedestrian_arrival`: 行人到達
  * `pedestrian_passthrough`: 行人通過斑馬線
  * `traffic_state_transform`: 號誌切換

### 3\. 隨機參數 (not confirmed)

  * **車輛到達**: 指數分佈 (Exponential)
  * **車輛通過時間**: 常態分佈 (Normal)，區分為「起步/暖身 (Warmup)」與「飽和車流 (Passthrough)」兩種速率。
  * **行人到達**: 指數分佈 (Exponential)

## 📂 檔案結構說明

| 檔案名稱 | 說明 |
| :--- | :--- |
| **`main.py`** | 程式進入點。定義了路口邏輯、事件處理 (Match-Case)、模擬參數與實驗迴圈。 |
| **`SimClasses.py`** | 模擬核心類別庫。包含 `EventCalendar`, `Entity`, `FIFOQueue`, `CTStat`/`DTStat` (統計物件) 等。 |
| **`SimFunctions.py`** | 模擬輔助函式。包含 `Schedule` (排程), `ClearStats` (清除統計), `SimFunctionsInit` (初始化) 等。 |
| **`SimRNG.py`** | 隨機數生成器 (Random Number Generator)。實作了 LCG 演算法與各種機率分佈 (Expon, Normal 等)。 |
| **`requirements.txt`** | 專案依賴套件列表。 |


## 🥺 前提假設

  * 所有車輛遵守交通規則(禮讓行人 & 直行車)
  * 車輛開始通過後無體積佔用車道


## 🚀 安裝與執行

### 環境需求

  * Python 3.10+

### 1\. 安裝依賴

```bash
pip install -r requirements.txt
```

### 2\. 執行模擬

```bash
python main.py
```

程式預設會執行 **10 次重複實驗 (Replications)**，每次模擬時長為 **10,800 秒**（其中前 3,600 秒為暖身期，統計數據會被清除）。

## 📊 輸出數據

模擬結束後，`main.py` 會收集以下績效指標（儲存於變數中，可進一步繪圖或列印）：

  * **WaitTimeCarAvg**: 各方向、各轉向的平均車輛等待時間。
  * **QueueLengthCarAvg**: 各方向、各轉向的平均車輛排隊長度。
  * **WaitTimePedestrianAvg**: 各路口行人的平均等待時間。

## 📝 參數設定

若需調整模擬情境，可修改 `main.py` 頂部的參數區域：

  * `traffic_cycle`: 調整紅綠燈秒數。
  * `car_arrival_parameters`: 調整車流量 (Beta值)。
  * `t_car_warmup_parameters` / `t_passthrough_parameters`: 調整車輛通過速率。

---
### **⚠️Partial readme.md generated by Gemini**